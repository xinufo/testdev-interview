# 混合支付场景的测试用例

## 需求描述

用户有积分，可用来购买商品，积分不足时需要用微信支付补足差额（必须优先使用积分支付）

## 测试用例

### 支付方式测试

- 商品价格小于等于现有积分，纯积分支付
- 商品价格大于现有积分，积分+微信支付
- 积分+微信余额支付
- 积分+微信银行卡支付
- 现有积分大于商品价格，用券或优惠，纯积分支付
- 现有积分小于商品价格，用券或优惠后现有积分大于等于所需余额，纯积分支付
- 用券或优惠后现有积分小于所需余额，积分+微信支付，根据需求抵扣积分或微信余额

### 余额测试

- 现有积分为0，支付失败
- 积分+微信支付，微信余额不足，支付失败
- 扣除积分后折算所需剩余金额小于微信最小支付金额，支付失败
- 扣除积分后折算所需剩余金额大于微信单笔限额，支付失败

### 支付过程测试

- 密码支付
- 指纹支付
- 人脸支付
- 验证失败（如密码错误等），支付失败
- 支付取消后再次支付，支付成功
- 一直不支付，订单超时
- 无网络环境下支付，支付失败
- 弱网环境下支付，支付成功
- 重复支付，第二次支付失败
- 验证积分扣除和微信余额扣除是否正确

### 支付回调测试

- 支付后一直等待至结果返回，支付成功
- 支付后在结果返回前关闭页面，支付成功
- 支付后在结果返回前刷新页面，支付成功且无重复支付

### 支付安全测试

- 多次验证失败，账号锁定
- 触发单笔限额、日限额、月限额等，支付失败
- 触发风控规则，支付失败
- 抓接口修改支付数据（如金额等）再发送，支付失败

### 逆向流程测试

- 纯积分支付退款
- 积分+微信余额支付退款
- 积分+微信银行卡支付退款
- 重复退款
- 有优惠活动或用券时，退款金额应为实际支付金额
- 抓接口修改退款数据（如金额等）再发送，退款失败